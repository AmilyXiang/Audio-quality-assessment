# NISQA éŸ³é¢‘è´¨é‡æ£€æµ‹ç³»ç»Ÿå®Œæ•´æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ‰§è¡Œæµç¨‹](#æ‰§è¡Œæµç¨‹)
3. [ä¸¤é˜¶æ®µåˆ¤å®šé€»è¾‘](#ä¸¤é˜¶æ®µåˆ¤å®šé€»è¾‘)
4. [å¸§çº§åˆ†æåŸç†](#å¸§çº§åˆ†æåŸç†)
5. [é—®é¢˜æ—¶æ®µè¯†åˆ«ç®—æ³•](#é—®é¢˜æ—¶æ®µè¯†åˆ«ç®—æ³•)
6. [ExcelæŠ¥å‘Šç”Ÿæˆ](#excelæŠ¥å‘Šç”Ÿæˆ)
7. [å®Œæ•´ç¤ºä¾‹](#å®Œæ•´ç¤ºä¾‹)
8. [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)

---

## ç³»ç»Ÿæ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½
- **åŸºçº¿å¯¹æ¯”åˆ†æ**ï¼šå°†æµ‹è¯•éŸ³é¢‘ä¸åŸºå‡†éŸ³é¢‘è¿›è¡Œé€å¸§å¯¹æ¯”
- **å¤šç»´åº¦è¯„ä¼°**ï¼š5ä¸ªè´¨é‡ç»´åº¦ï¼ˆMOS, NOI, DIS, COL, LOUDï¼‰
- **ç²¾ç¡®é—®é¢˜å®šä½**ï¼šè¯†åˆ«é—®é¢˜å‘ç”Ÿçš„å…·ä½“æ—¶é—´æ®µ
- **è‡ªåŠ¨åŒ–æŠ¥å‘Š**ï¼šç”ŸæˆExcelæ ¼å¼çš„é—®é¢˜è¯Šæ–­æŠ¥å‘Š

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NISQA è´¨é‡æ£€æµ‹ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Step 1: å¸§çº§è¯„åˆ†                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    NISQAæ¨¡å‹    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚åŸºå‡†éŸ³é¢‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚Frameè¯„åˆ† â”‚                 â”‚
â”‚  â”‚(Baseline)â”‚    15sçª—/0.5sè·³ â”‚29å¸§Ã—5ç»´åº¦â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚       â†“                             â†“                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚æµ‹è¯•éŸ³é¢‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚Frameè¯„åˆ† â”‚                 â”‚
â”‚  â”‚(Test)    â”‚    åŒæ ·é…ç½®      â”‚29å¸§Ã—5ç»´åº¦â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                     â†“                        â”‚
â”‚  Step 2: å¸§åºåˆ—å¯¹é½                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  Cross-Correlation (äº’ç›¸å…³å¯¹é½)      â”‚                    â”‚
â”‚  â”‚  æ£€æµ‹æ—¶é—´åç§» lagï¼Œå¯¹é½ä¸¤ä¸ªåºåˆ—       â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                    â†“                                         â”‚
â”‚  Step 3: é€å¸§å·®å€¼è®¡ç®—                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  diff = test_value - baseline_value  â”‚                    â”‚
â”‚  â”‚  æ­£å€¼ = ä¼˜äºåŸºå‡† | è´Ÿå€¼ = åŠ£äºåŸºå‡†   â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                    â†“                                         â”‚
â”‚  Step 4: æ··åˆåˆ¤å®šï¼ˆæ–¹æ¡ˆ3ï¼‰                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  1. å¸§çº§åŠ£åŒ–æ¯”ä¾‹ï¼ˆä¸»è¦ä¾æ®ï¼‰         â”‚                    â”‚
â”‚  â”‚  2. ä¸¥é‡çªå˜æ£€æµ‹ï¼ˆè¾…åŠ©ä¾æ®ï¼‰         â”‚                    â”‚
â”‚  â”‚  3. æ–‡ä»¶çº§å·®å€¼ï¼ˆå‚è€ƒä¾æ®ï¼‰           â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                    â†“                                         â”‚
â”‚  Step 5: ç»“æœè¾“å‡º                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚OK/NOKåˆ¤å®šâ”‚è¶‹åŠ¿å›¾PNG â”‚è¯¦ç»†JSON  â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```

---

## æ‰§è¡Œæµç¨‹

### å®Œæ•´åˆ†ææµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤1: éŸ³é¢‘åŠ è½½ä¸NISQAè¯„åˆ†                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥: baseline.wav, test.wav                                   â”‚
â”‚ â†“                                                              â”‚
â”‚ NISQAæ¨¡å‹åˆ†æ (15ç§’çª—å£, 0.5ç§’æ­¥è¿›)                           â”‚
â”‚ â†“                                                              â”‚
â”‚ è¾“å‡º: æ¯ä¸ªéŸ³é¢‘çš„å¸§çº§è¯„åˆ† (29å¸§ Ã— 5ç»´åº¦)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤2: å¸§åºåˆ—å¯¹é½                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½¿ç”¨Cross-Correlationæ£€æµ‹æ—¶é—´åç§»                             â”‚
â”‚ â†“                                                              â”‚
â”‚ å¯¹é½åŸºå‡†å’Œæµ‹è¯•å¸§åºåˆ—                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤3: é€å¸§å·®å€¼è®¡ç®—                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¯¹æ¯ä¸ªç»´åº¦è®¡ç®—: diff = test - baseline                        â”‚
â”‚ â†“                                                              â”‚
â”‚ ç”Ÿæˆå·®å€¼ç»Ÿè®¡ (mean, median, std, min, max, åŠ£åŒ–æ¯”ä¾‹)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤4: ä¸¤é˜¶æ®µOK/NOKåˆ¤å®š                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é˜¶æ®µ1: MOSç»´åº¦åˆ¤å®š (ä¸»è¦åˆ¤æ–­)                                 â”‚
â”‚   - æ£€æŸ¥å¸§çº§åŠ£åŒ–æ¯”ä¾‹                                           â”‚
â”‚   - æ£€æŸ¥ä¸¥é‡çªå˜                                               â”‚
â”‚   - æ£€æŸ¥æ–‡ä»¶çº§å·®å€¼                                             â”‚
â”‚ â†“                                                              â”‚
â”‚ é˜¶æ®µ2: å…¶ä»–ç»´åº¦éªŒè¯ (NOI, DIS, COL, LOUD)                     â”‚
â”‚   - ä»…åœ¨MOSåˆ¤å®šä¸ºNOKæ—¶æ‰§è¡Œ                                     â”‚
â”‚   - ä½¿ç”¨ç›¸åŒè§„åˆ™éªŒè¯                                           â”‚
â”‚ â†“                                                              â”‚
â”‚ è¾“å‡º: status=OK/NOK + é—®é¢˜åŸå› è¯´æ˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤5: é—®é¢˜æ—¶æ®µè¯†åˆ« (ä»…NOKæ–‡ä»¶)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æå–é—®é¢˜å¸§ (diff < -0.3)                                      â”‚
â”‚ â†“                                                              â”‚
â”‚ è¯†åˆ«è¿ç»­é—®é¢˜å¸§ç»„                                               â”‚
â”‚ â†“                                                              â”‚
â”‚ åº”ç”¨è¾¹ç•Œåˆ†æç®—æ³•:                                              â”‚
â”‚   - å­¤ç«‹å¸§: ä¸ç›¸é‚»OKå¸§æ¯”è¾ƒè¾¹ç•Œå·®å¼‚                            â”‚
â”‚   - è¿ç»­å¸§: é¦–å°¾å·®å¼‚åˆ†æ                                       â”‚
â”‚ â†“                                                              â”‚
â”‚ è¾“å‡º: ç²¾ç¡®é—®é¢˜æ—¶é—´æ®µåˆ—è¡¨                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤6: ç»“æœè¾“å‡º                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. JSONæŠ¥å‘Š (baseline_compare_*.json)                         â”‚
â”‚ 2. å¯è§†åŒ–å›¾è¡¨ (baseline_compare_*.png)                        â”‚
â”‚ 3. Excelæ±‡æ€»æŠ¥å‘Š (problem_files_report.xlsx)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸¤é˜¶æ®µåˆ¤å®šé€»è¾‘

### è®¾è®¡ç†å¿µ

**ä¸ºä»€ä¹ˆé‡‡ç”¨ä¸¤é˜¶æ®µåˆ¤å®šï¼Ÿ**
1. **MOSæ˜¯æœ€æƒå¨çš„æ€»ä½“è´¨é‡è¯„åˆ†** - ç»¼åˆè€ƒè™‘æ‰€æœ‰å› ç´ 
2. **é¿å…è¿‡åº¦è¯Šæ–­** - ä¸æ˜¯æ‰€æœ‰ç»´åº¦éƒ½åŒæ ·é‡è¦
3. **æé«˜æ•ˆç‡** - ä¼˜å…ˆåˆ¤æ–­ä¸»è¦ç»´åº¦ï¼Œå‡å°‘ä¸å¿…è¦çš„è®¡ç®—

### é˜¶æ®µ1: MOSç»´åº¦åˆ¤å®šï¼ˆä¸»åˆ¤æ–­ï¼‰

```python
def _check_mos_quality(frame_diffs, file_level_diff):
    """ç¬¬ä¸€é˜¶æ®µï¼šMOSåˆ¤å®š"""
    
    # è§„åˆ™1: å¸§çº§åŠ£åŒ–æ¯”ä¾‹
    frames_below = sum(1 for f in frame_diffs if f['diff'] < -0.3)
    below_percentage = (frames_below / len(frame_diffs)) * 100
    
    if below_percentage >= 50:
        return "NOK", f"{below_percentage:.0f}%å¸§åŠ£åŒ–"
    
    # è§„åˆ™2: ä¸¥é‡çªå˜æ£€æµ‹
    severe_drops = [f for f in frame_diffs if f['diff'] < -0.5]
    if len(severe_drops) >= 3:
        return "NOK", f"{len(severe_drops)}ä¸ªä¸¥é‡çªå˜å¸§"
    
    # è§„åˆ™3: æ–‡ä»¶çº§å·®å€¼
    if file_level_diff < -0.3:
        return "NOK", f"æ–‡ä»¶çº§åŠ£åŒ–{file_level_diff:.2f}"
    
    return "OK", "MOSç»´åº¦æ­£å¸¸"
```

**åˆ¤å®šé˜ˆå€¼è¯´æ˜ï¼š**
- **å¸§çº§é˜ˆå€¼**: `-0.3` - ä½äºæ­¤å€¼è®¤ä¸ºè¯¥å¸§è´¨é‡åŠ£åŒ–
- **åŠ£åŒ–æ¯”ä¾‹**: `50%` - ä¸€åŠä»¥ä¸Šå¸§åŠ£åŒ–åˆ™åˆ¤å®šNOK
- **ä¸¥é‡é˜ˆå€¼**: `-0.5` - æåº¦åŠ£åŒ–
- **æ–‡ä»¶çº§é˜ˆå€¼**: `-0.3` - æ•´ä½“è¯„åˆ†åŠ£åŒ–

### é˜¶æ®µ2: å…¶ä»–ç»´åº¦éªŒè¯ï¼ˆè¾…åŠ©åˆ¤æ–­ï¼‰

```python
def judge_quality(comparison_data):
    """ä¸¤é˜¶æ®µåˆ¤å®šä¸»å‡½æ•°"""
    
    # é˜¶æ®µ1: MOSåˆ¤å®š
    mos_status, mos_reason = _check_mos_quality(...)
    
    if mos_status == "OK":
        return {
            "status": "OK",
            "reason": "MOSç»´åº¦æ­£å¸¸",
            "details": {...}
        }
    
    # é˜¶æ®µ2: å…¶ä»–ç»´åº¦éªŒè¯ï¼ˆä»…åœ¨MOS=NOKæ—¶ï¼‰
    problem_dims = {}
    for dim in ['noi', 'dis', 'col', 'loud']:
        status, reason = _check_dimension_quality(dim, ...)
        if status == "NOK":
            problem_dims[dim.upper()] = reason
    
    # æ±‡æ€»ç»“æœ
    return {
        "status": "NOK",
        "reason": f"MOS: {mos_reason}",
        "problem_dimensions": problem_dims,
        "details": {...}
    }
```

**åˆ¤å®šé€»è¾‘ç¤ºæ„ï¼š**
```
MOSç»´åº¦åˆ¤å®š
    â†“
  OK? â”€â”€â”€YESâ”€â”€â†’ è¿”å› OKï¼ˆè·³è¿‡å…¶ä»–ç»´åº¦æ£€æŸ¥ï¼‰
    â†“
   NO
    â†“
æ£€æŸ¥ NOI/DIS/COL/LOUD ç»´åº¦
    â†“
æ±‡æ€»æ‰€æœ‰é—®é¢˜ç»´åº¦
    â†“
è¿”å› NOK + è¯¦ç»†é—®é¢˜åˆ—è¡¨
```

---

## å¸§çº§åˆ†æåŸç†

### NISQAå¸§çª—å£æœºåˆ¶

**æ»‘åŠ¨çª—å£åˆ†æï¼š**
- **çª—å£å¤§å°**: 15ç§’
- **æ­¥è¿›å¤§å°**: 0.5ç§’
- **çª—å£é‡å **: 14.5ç§’ (97%é‡å ç‡)

**å¸§æ—¶é—´è®¡ç®—ï¼š**
```
Frame 0:  [0.0s  - 15.0s]
Frame 1:  [0.5s  - 15.5s]
Frame 2:  [1.0s  - 16.0s]
Frame 3:  [1.5s  - 16.5s]
...
Frame N:  [NÃ—0.5s - NÃ—0.5+15s]
```

### ä¸ºä»€ä¹ˆéœ€è¦å¸§çº§åˆ†æï¼Ÿ

**æ–‡ä»¶çº§è¯„åˆ†çš„å±€é™æ€§ï¼š**
- ä½¿ç”¨å¤æ‚çš„å…¨å±€ç®—æ³•ï¼Œå¯èƒ½"å¹³æ»‘"æ‰å±€éƒ¨é—®é¢˜
- æ— æ³•å®šä½é—®é¢˜å‘ç”Ÿçš„å…·ä½“æ—¶é—´
- å¯èƒ½å‡ºç°"æ–‡ä»¶çº§æ­£å¸¸ï¼Œä½†å¸§çº§å…¨éƒ¨åŠ£åŒ–"çš„çŸ›ç›¾

**çœŸå®æ¡ˆä¾‹ï¼š**
```json
{
  "file_level": {
    "test_mos": 3.2,    // çœ‹èµ·æ¥æ­£å¸¸
    "baseline_mos": 3.5,
    "diff": -0.3        // å·®å¼‚ä¸å¤§
  },
  "frame_level": {
    "frames_below_baseline": 28,  // 96%å¸§åŠ£åŒ–ï¼
    "total_frames": 29
  },
  "åˆ¤å®š": "NOK - å¸§çº§è¶‹åŠ¿ä¸¥é‡åŠ£åŒ–"
}
```

### å¸§å·®å€¼ç»Ÿè®¡

```python
for each dimension in [mos, noi, dis, col, loud]:
    diffs = [frame.test - frame.baseline for frame in aligned_frames]
    
    stats = {
        "mean_diff": np.mean(diffs),
        "median_diff": np.median(diffs),
        "std_diff": np.std(diffs),
        "min_diff": np.min(diffs),
        "max_diff": np.max(diffs),
        "frames_below_baseline": sum(1 for d in diffs if d < 0),
        "percent_below_baseline": (frames_below / total) * 100
    }
```

---

## é—®é¢˜æ—¶æ®µè¯†åˆ«ç®—æ³•

### ç®—æ³•ç›®æ ‡

**æŒ‘æˆ˜ï¼š** NISQAä½¿ç”¨15ç§’æ»‘åŠ¨çª—å£ï¼Œ**97%é‡å **ï¼Œå¦‚ä½•ç²¾ç¡®å®šä½é—®é¢˜æ—¶åˆ»ï¼Ÿ

**ç¤ºä¾‹åœºæ™¯ï¼š**
```
Frame 14 (7.0-22.0s)  âœ— é—®é¢˜
Frame 15 (7.5-22.5s)  âœ— é—®é¢˜  
Frame 16 (8.0-23.0s)  âœ— é—®é¢˜
Frame 17 (8.5-23.5s)  âœ— é—®é¢˜

é—®é¢˜: å“ªäº›æ—¶é—´æ®µçœŸæ­£æœ‰é—®é¢˜ï¼Ÿ
ç­”æ¡ˆ: ä¸æ˜¯æ•´ä¸ª7-23.5sï¼Œè€Œæ˜¯è¾¹ç•Œå¤„ï¼
```

### æ··åˆè¾¹ç•Œåˆ†æç­–ç•¥

#### 1. è¯†åˆ«è¿ç»­é—®é¢˜å¸§ç»„

```python
def identify_consecutive_groups(problem_frames):
    """è¯†åˆ«è¿ç»­é—®é¢˜å¸§"""
    groups = []
    current_group = [problem_frames[0]]
    
    for i in range(1, len(problem_frames)):
        if problem_frames[i]['frame_id'] == problem_frames[i-1]['frame_id'] + 1:
            # è¿ç»­
            current_group.append(problem_frames[i])
        else:
            # ä¸è¿ç»­ï¼Œä¿å­˜å½“å‰ç»„ï¼Œå¼€å§‹æ–°ç»„
            groups.append(current_group)
            current_group = [problem_frames[i]]
    
    groups.append(current_group)
    return groups
```

**åˆ†ç»„ç¤ºä¾‹ï¼š**
```
é—®é¢˜å¸§: [2, 11, 14, 15, 16, 17]
     â†“
åˆ†ç»„ç»“æœ:
  - ç»„1: [Frame 2]           (å­¤ç«‹)
  - ç»„2: [Frame 11]          (å­¤ç«‹)
  - ç»„3: [Frame 14-17]       (è¿ç»­4ä¸ª)
```

#### 2. å­¤ç«‹é—®é¢˜å¸§ï¼šç›¸é‚»OKå¸§è¾¹ç•Œåˆ†æ

**ç®—æ³•é€»è¾‘ï¼š**
```
å­¤ç«‹é—®é¢˜å¸§ Frame N:
  â†“
æ£€æŸ¥ Frame N-1 (å‰ä¸€å¸§)
  - å¦‚æœOK: å– Frame N ç›¸å¯¹äº N-1 çš„æ–°å¢åéƒ¨
  â†“
æ£€æŸ¥ Frame N+1 (åä¸€å¸§)
  - å¦‚æœOK: å– Frame N ç›¸å¯¹äº N+1 çš„æ–°å¢å‰éƒ¨
```

**ä»£ç å®ç°ï¼š**
```python
def analyze_isolated_frame(prob_frame, all_frames):
    """å­¤ç«‹å¸§ï¼šä¸ç›¸é‚»OKå¸§æ¯”è¾ƒ"""
    boundaries = []
    
    # å‰ä¸€å¸§ (N-1)
    prev_frame = all_frames.get(prob_frame['frame_id'] - 1)
    if prev_frame and prev_frame['diff'] >= -0.3:  # OKå¸§
        # é—®é¢˜å¸§çš„æ–°å¢åéƒ¨
        if prob_frame['time_end'] > prev_frame['time_end']:
            boundaries.append((prev_frame['time_end'], prob_frame['time_end']))
    
    # åä¸€å¸§ (N+1)
    next_frame = all_frames.get(prob_frame['frame_id'] + 1)
    if next_frame and next_frame['diff'] >= -0.3:  # OKå¸§
        # é—®é¢˜å¸§çš„æ–°å¢å‰éƒ¨
        if prob_frame['time_start'] < next_frame['time_start']:
            boundaries.append((prob_frame['time_start'], next_frame['time_start']))
    
    return boundaries
```

**ç¤ºä¾‹ï¼š**
```
Frame 1  (0.5-15.5s)  âœ“ OK
Frame 2  (1.0-16.0s)  âœ— é—®é¢˜
Frame 3  (1.5-16.5s)  âœ“ OK

åˆ†æ:
  Frame 2 vs Frame 1: æ–°å¢åéƒ¨ 15.5-16.0s
  Frame 2 vs Frame 3: æ–°å¢å‰éƒ¨ 1.0-1.5s
  
ç»“æœ: Frame 2çš„é—®é¢˜æ—¶æ®µ = [1.0-1.5s, 15.5-16.0s]
```

#### 3. è¿ç»­é—®é¢˜å¸§ï¼šé¦–å°¾å·®å¼‚åˆ†æ

**ç®—æ³•é€»è¾‘ï¼š**
```
è¿ç»­é—®é¢˜å¸§ç»„ [Frame N, N+1, ..., N+M]:
  â†“
ç¬¬ä¸€ä¸ªé—®é¢˜å¸§ (Frame N)
  â†“
æœ€åä¸€ä¸ªé—®é¢˜å¸§ (Frame N+M)
  â†“
å‰éƒ¨å·®å¼‚: Nçš„å‰éƒ¨ - (N+M)çš„å‰éƒ¨ = Nç‹¬æœ‰çš„å‰éƒ¨
åéƒ¨å·®å¼‚: (N+M)çš„åéƒ¨ - Nçš„åéƒ¨ = (N+M)ç‹¬æœ‰çš„åéƒ¨
```

**ä»£ç å®ç°ï¼š**
```python
def analyze_consecutive_frames(group):
    """è¿ç»­å¸§ï¼šé¦–å°¾å·®å¼‚åˆ†æ"""
    first_frame = group[0]
    last_frame = group[-1]
    
    boundaries = []
    
    # å‰éƒ¨å·®å¼‚ï¼šç¬¬ä¸€ä¸ªé—®é¢˜å¸§ç‹¬æœ‰çš„å‰éƒ¨
    if first_frame['time_start'] < last_frame['time_start']:
        boundaries.append((
            first_frame['time_start'],
            last_frame['time_start']
        ))
    
    # åéƒ¨å·®å¼‚ï¼šæœ€åä¸€ä¸ªé—®é¢˜å¸§ç‹¬æœ‰çš„åéƒ¨
    if last_frame['time_end'] > first_frame['time_end']:
        boundaries.append((
            first_frame['time_end'],
            last_frame['time_end']
        ))
    
    return boundaries
```

**ç¤ºä¾‹ï¼š**
```
Frame 14 (7.0-22.0s)   âœ— é—®é¢˜
Frame 15 (7.5-22.5s)   âœ— é—®é¢˜
Frame 16 (8.0-23.0s)   âœ— é—®é¢˜  
Frame 17 (8.5-23.5s)   âœ— é—®é¢˜

åˆ†æ:
  ç¬¬ä¸€ä¸ª: Frame 14 (7.0-22.0s)
  æœ€åä¸ª: Frame 17 (8.5-23.5s)
  
  å‰éƒ¨å·®å¼‚: 7.0 - 8.5 = 7.0-8.5s   (Frame 14ç‹¬æœ‰)
  åéƒ¨å·®å¼‚: 23.5 - 22.0 = 22.0-23.5s (Frame 17ç‹¬æœ‰)
  
ç»“æœ: é—®é¢˜æ—¶æ®µ = [7.0-8.5s, 22.0-23.5s]
```

### å®Œæ•´ç®—æ³•æµç¨‹

```python
def compute_problem_regions(problem_frames, normal_frames):
    """æ··åˆè¾¹ç•Œåˆ†æä¸»å‡½æ•°"""
    
    # 1. æ„å»ºæ‰€æœ‰å¸§æ˜ å°„
    all_frames = {f['frame_id']: f for f in problem_frames + normal_frames}
    
    # 2. è¯†åˆ«è¿ç»­é—®é¢˜å¸§ç»„
    consecutive_groups = identify_consecutive_groups(problem_frames)
    
    # 3. å¯¹æ¯ç»„åº”ç”¨ä¸åŒç­–ç•¥
    all_problem_regions = []
    
    for group in consecutive_groups:
        if len(group) == 1:
            # å­¤ç«‹å¸§ï¼šç›¸é‚»OKå¸§è¾¹ç•Œåˆ†æ
            regions = analyze_isolated_frame(group[0], all_frames)
        else:
            # è¿ç»­å¸§ï¼šé¦–å°¾å·®å¼‚åˆ†æ
            regions = analyze_consecutive_frames(group)
        
        all_problem_regions.extend(regions)
    
    # 4. åˆå¹¶é‡å åŒºåŸŸ
    merged_regions = merge_intervals(all_problem_regions)
    
    # 5. è¿‡æ»¤çŸ­åŒºåŸŸï¼ˆ<0.5ç§’ï¼‰
    final_regions = [
        f"{start:.1f}-{end:.1f}s" 
        for start, end in merged_regions 
        if end - start >= 0.5
    ]
    
    return final_regions
```

---

## ExcelæŠ¥å‘Šç”Ÿæˆ

### æŠ¥å‘Šæ ¼å¼

**æ–‡ä»¶å**: `problem_files_report_v6.xlsx`

**è¡¨æ ¼ç»“æ„ï¼š**
```
è¡Œ1æ ‡é¢˜: æ–‡ä»¶å | MOS | NOI | DIS | COL | LOUD
è¡Œ1æ•°æ®: xxx.wav | 0,1,2 | 5,7 | - | - | 2,14,15,16,17
è¡Œ2æ•°æ®: â†³æ—¶é—´æ®µ | 0.0-1.0s, 1.5-2.0s | 2.5-3.0s, 3.5-4.0s | - | - | 1.0-1.5s, 7.0-8.5s, 22.0-23.5s
è¡Œ3æ ‡é¢˜: ä¸‹ä¸€ä¸ªæ–‡ä»¶...
```

### ç”Ÿæˆæµç¨‹

```python
def generate_excel_report(json_dir, output_file):
    """ç”ŸæˆExcelæŠ¥å‘Šä¸»å‡½æ•°"""
    
    # 1. æ‰«ææ‰€æœ‰baseline_compare_*.jsonæ–‡ä»¶
    comparison_files = glob.glob(f"{json_dir}/baseline_compare_*.json")
    
    # 2. è¿‡æ»¤OKæ–‡ä»¶ï¼Œåªå¤„ç†NOK
    nok_files = []
    for file in comparison_files:
        data = load_json(file)
        if data['status'] == 'NOK':
            nok_files.append(file)
    
    # 3. æå–é—®é¢˜å¸§å’Œæ—¶æ®µ
    for file in nok_files:
        data = load_json(file)
        problem_data = extract_problem_frames(data, threshold=-0.3)
        
        # å¯¹æ¯ä¸ªç»´åº¦
        for dim in ['MOS', 'NOI', 'DIS', 'COL', 'LOUD']:
            problem_frames = problem_data[dim]['frames']
            time_ranges = problem_data[dim]['time_ranges']
            
            # å†™å…¥Excel
            append_to_excel(file, dim, problem_frames, time_ranges)
    
    # 4. æ ¼å¼åŒ–Excel
    apply_excel_formatting(output_file)
```

### æ ·å¼è®¾ç½®

```python
def apply_excel_formatting(ws):
    """Excelæ ·å¼è®¾ç½®"""
    
    # æ ‡é¢˜è¡Œæ ·å¼
    header_fill = PatternFill(
        start_color="366092",
        end_color="366092"
        fill_type="solid"
    )
    header_font = Font(bold=True, color="FFFFFF", size=12)
    
    # åˆ—å®½è®¾ç½®
    ws.column_dimensions['A'].width = 40  # æ–‡ä»¶å
    for col in ['B', 'C', 'D', 'E', 'F']:
        ws.column_dimensions[col].width = 30  # ç»´åº¦åˆ—
    
    # è¾¹æ¡†
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
    
    # å±…ä¸­å¯¹é½
    alignment = Alignment(horizontal='center', vertical='center')
```

---

## å®Œæ•´ç¤ºä¾‹

### åœºæ™¯ï¼šéŸ³é‡è¿‡ä½é—®é¢˜æ£€æµ‹

**è¾“å…¥æ–‡ä»¶ï¼š**
- `baseline.wav`: æ­£å¸¸éŸ³é¢‘
- `test.wav`: éŸ³é‡è¿‡ä½çš„æµ‹è¯•éŸ³é¢‘

**æ‰§è¡Œå‘½ä»¤ï¼š**
```bash
cd voice_quality_tool
python nisqa/analyze_nisqa_baseline_compare.py \
    --baseline ../normal/baseline.wav \
    --test ../normal/test.wav \
    --model nisqa/weights/nisqa.tar \
    --output_dir nisqa
```

**è¾“å‡º1: JSONæŠ¥å‘Š** (`baseline_compare_test.json`)
```json
{
  "test_file": "test.wav",
  "baseline_file": "baseline.wav",
  "status": "NOK",
  "reason": "MOS: 90%å¸§åŠ£åŒ– ä¸” æ–‡ä»¶çº§åŠ£åŒ–-0.24",
  "problem_dimensions": {
    "LOUD": "90%å¸§åŠ£åŒ– ä¸” æ–‡ä»¶çº§åŠ£åŒ–-0.24"
  },
  "file_level": {
    "test": {"mos": 2.26, "noi": 3.27, "dis": 3.79, "col": 2.12, "loud": 2.26},
    "baseline": {"mos": 2.60, "noi": 3.25, "dis": 3.59, "col": 2.20, "loud": 2.50},
    "diff": {"mos": -0.35, "noi": 0.02, "dis": 0.20, "col": -0.08, "loud": -0.24}
  },
  "metrics": {
    "loud": {
      "frame_diffs": [
        {"frame_id": 0, "time_start": 0.0, "time_end": 15.0, "diff": -0.128},
        {"frame_id": 1, "time_start": 0.5, "time_end": 15.5, "diff": -0.164},
        {"frame_id": 2, "time_start": 1.0, "time_end": 16.0, "diff": -0.384},
        ...
        {"frame_id": 14, "time_start": 7.0, "time_end": 22.0, "diff": -0.465},
        {"frame_id": 15, "time_start": 7.5, "time_end": 22.5, "diff": -0.371},
        {"frame_id": 16, "time_start": 8.0, "time_end": 23.0, "diff": -0.354},
        {"frame_id": 17, "time_start": 8.5, "time_end": 23.5, "diff": -0.469}
      ],
      "stats": {
        "mean_diff": -0.175,
        "percent_below_baseline": 89.7,
        "min_diff": -0.469,
        "max_diff": 0.137
      }
    }
  }
}
```

**è¾“å‡º2: å¯è§†åŒ–å›¾è¡¨** (`baseline_compare_test.png`)
- 5ä¸ªç»´åº¦çš„è¶‹åŠ¿å¯¹æ¯”å›¾
- çº¢è‰²åŒºåŸŸï¼šæµ‹è¯•éŸ³é¢‘åŠ£äºåŸºå‡†
- è“è‰²åŒºåŸŸï¼šæµ‹è¯•éŸ³é¢‘ä¼˜äºåŸºå‡†

**è¾“å‡º3: Excelæ±‡æ€»æŠ¥å‘Š**

ç”ŸæˆExcelå‘½ä»¤ï¼š
```bash
python nisqa/generate_problem_excel.py nisqa --output nisqa/problem_files_report_v6.xlsx
```

Excelå†…å®¹ï¼š
```
â”‚ æ–‡ä»¶å     â”‚ MOS â”‚ NOI â”‚ DIS â”‚ COL â”‚ LOUD                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ test.wav   â”‚ 17  â”‚ 0,1 â”‚  -  â”‚  -  â”‚ 2, 11, 14, 15, 16, 17                â”‚
â”‚ â†³æ—¶é—´æ®µ    â”‚ ... â”‚ ... â”‚  -  â”‚  -  â”‚ 1.0-1.5s, 5.5-6.0s, 7.0-8.5s, 22.0- â”‚
â”‚            â”‚     â”‚     â”‚     â”‚     â”‚ 23.5s                                 â”‚
```

**é—®é¢˜æ—¶æ®µåˆ†æï¼š**
```
LOUDç»´åº¦é—®é¢˜å¸§: [2, 11, 14, 15, 16, 17]

åˆ†ç»„:
  - Frame 2 (å­¤ç«‹) â†’ è¾¹ç•Œåˆ†æ â†’ 1.0-1.5s, 15.5-16.0s
  - Frame 11 (å­¤ç«‹) â†’ è¾¹ç•Œåˆ†æ â†’ 5.5-6.0s, 20.0-20.5s
  - Frame 14-17 (è¿ç»­) â†’ é¦–å°¾å·®å¼‚ â†’ 7.0-8.5s, 22.0-23.5s

æœ€ç»ˆé—®é¢˜æ—¶æ®µ: 
  1.0-1.5s, 5.5-6.0s, 7.0-8.5s, 15.5-16.0s, 20.0-20.5s, 22.0-23.5s
```

---

## ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ç”¨æ³•

**å•æ–‡ä»¶å¯¹æ¯”ï¼š**
```bash
python nisqa/analyze_nisqa_baseline_compare.py \
    --baseline baseline.wav \
    --test test.wav \
    --model nisqa/weights/nisqa.tar \
    --output_dir output
```

**æ‰¹é‡å¯¹æ¯”ï¼ˆç›®å½•ï¼‰ï¼š**
```bash
python nisqa/analyze_nisqa_baseline_compare.py \
    --baseline baseline.wav \
    --test-dir test_folder/ \
    --model nisqa/weights/nisqa.tar \
    --output_dir output \
    --cleanup-framewise  # æ¸…ç†é€å¸§JSON
```

**ç”ŸæˆExcelæŠ¥å‘Šï¼š**
```bash
python nisqa/generate_problem_excel.py output_dir \
    --output problem_report.xlsx
```

### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--baseline` | åŸºå‡†éŸ³é¢‘è·¯å¾„ | å¿…å¡« |
| `--test` | æµ‹è¯•éŸ³é¢‘è·¯å¾„ | å¯é€‰ |
| `--test-dir` | æµ‹è¯•éŸ³é¢‘ç›®å½• | å¯é€‰ |
| `--model` | NISQAæ¨¡å‹è·¯å¾„ | å¿…å¡« |
| `--output_dir` | è¾“å‡ºç›®å½• | `./nisqa` |
| `--cleanup-framewise` | æ¸…ç†é€å¸§JSON | å¦ |
| `--output` | Excelè¾“å‡ºè·¯å¾„ | å¿…å¡«ï¼ˆExcelç”Ÿæˆæ—¶ï¼‰|

### é˜ˆå€¼è°ƒæ•´

å¯åœ¨ä»£ç ä¸­ä¿®æ”¹åˆ¤å®šé˜ˆå€¼ï¼š

```python
# generate_problem_excel.py
FRAME_THRESHOLD = -0.3      # é—®é¢˜å¸§é˜ˆå€¼
MIN_REGION_DURATION = 0.5    # æœ€å°é—®é¢˜æ—¶æ®µï¼ˆç§’ï¼‰

# analyze_nisqa_baseline_compare.py
DEGRADATION_RATIO = 0.5      # åŠ£åŒ–æ¯”ä¾‹é˜ˆå€¼ (50%)
SEVERE_DROP_THRESHOLD = -0.5  # ä¸¥é‡çªå˜é˜ˆå€¼
FILE_LEVEL_THRESHOLD = -0.3   # æ–‡ä»¶çº§é˜ˆå€¼
```

### è¾“å‡ºæ–‡ä»¶

**æ¯æ¬¡å¯¹æ¯”åˆ†æç”Ÿæˆï¼š**
1. `baseline_compare_<filename>.json` - è¯¦ç»†å¯¹æ¯”ç»“æœ
2. `baseline_compare_<filename>.png` - å¯è§†åŒ–è¶‹åŠ¿å›¾
3. `framewise_<filename>.json` - é€å¸§è¯„åˆ†ï¼ˆå¯é€‰ä¿ç•™ï¼‰

**ExcelæŠ¥å‘Šç”Ÿæˆï¼š**
1. `problem_files_report_v6.xlsx` - NOKæ–‡ä»¶æ±‡æ€»æŠ¥å‘Š

---

## æŠ€æœ¯ç»†èŠ‚

### NISQAæ¨¡å‹å‚æ•°

```python
NISQA_CONFIG = {
    'ms_seg_length': 15000,    # 15ç§’çª—å£ (æ¯«ç§’)
    'ms_hop_length': 500,      # 0.5ç§’æ­¥è¿› (æ¯«ç§’)
    'sampling_rate': 16000,    # 16kHz
    'seg_length': 15.0,        # ç§’
    'hop_length': 0.5          # ç§’
}
```

### è¾¹ç•Œåˆ†æé˜ˆå€¼

| é˜ˆå€¼ç±»å‹ | æ•°å€¼ | è¯´æ˜ |
|---------|------|------|
| é—®é¢˜å¸§åˆ¤å®š | -0.3 | diff < -0.3 è®¤ä¸ºè´¨é‡åŠ£åŒ– |
| ä¸¥é‡åŠ£åŒ– | -0.5 | æåº¦è´¨é‡é—®é¢˜ |
| æœ€å°æ—¶æ®µ | 0.5s | è¿‡æ»¤çŸ­äº0.5ç§’çš„é—®é¢˜ç‰‡æ®µ |
| OKå¸§åˆ¤å®š | â‰¥-0.3 | diff â‰¥ -0.3 è®¤ä¸ºæ­£å¸¸ |

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ‰¹é‡å¤„ç†æ—¶ä½¿ç”¨ `--cleanup-framewise`** - å‡å°‘ç£ç›˜å ç”¨
2. **ä½¿ç”¨SSD** - åŠ å¿«æ–‡ä»¶è¯»å†™
3. **GPUåŠ é€Ÿ** - NISQAæ”¯æŒCUDAï¼ˆéœ€é…ç½®ï¼‰
4. **å¹¶è¡Œå¤„ç†** - å¯ç¼–å†™è„šæœ¬å¹¶è¡Œåˆ†æå¤šä¸ªæ–‡ä»¶

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæ–‡ä»¶çº§OKä½†åˆ¤å®šä¸ºNOKï¼Ÿ

**A:** å¸§çº§åˆ†ææ›´æ•æ„Ÿã€‚æ–‡ä»¶çº§è¯„åˆ†ä½¿ç”¨å¤æ‚çš„å…¨å±€ç®—æ³•å¯èƒ½"å¹³æ»‘"æ‰å±€éƒ¨é—®é¢˜ï¼Œè€Œå¸§çº§åˆ†æèƒ½å‘ç°å¤§éƒ¨åˆ†æ—¶æ®µçš„åŠ£åŒ–è¶‹åŠ¿ã€‚

### Q2: é—®é¢˜æ—¶æ®µä¸ºä»€ä¹ˆä¸æ˜¯æ•´ä¸ªçª—å£ï¼Ÿ

**A:** NISQAä½¿ç”¨15ç§’æ»‘åŠ¨çª—å£ï¼Œ97%é‡å ã€‚è¾¹ç•Œåˆ†æç®—æ³•é€šè¿‡æ¯”è¾ƒç›¸é‚»å¸§çš„å·®å¼‚ï¼Œç²¾ç¡®å®šä½çœŸæ­£çš„é—®é¢˜è¾¹ç•Œï¼Œè€Œä¸æ˜¯ç®€å•åˆ—å‡ºé—®é¢˜çª—å£ã€‚

### Q3: å¦‚ä½•è°ƒæ•´åˆ¤å®šä¸¥æ ¼ç¨‹åº¦ï¼Ÿ

**A:** ä¿®æ”¹ä»¥ä¸‹é˜ˆå€¼ï¼š
- æ›´ä¸¥æ ¼ï¼šé™ä½ `FRAME_THRESHOLD` (å¦‚ -0.2)ã€é™ä½ `DEGRADATION_RATIO` (å¦‚ 0.3)
- æ›´å®½æ¾ï¼šæé«˜é˜ˆå€¼ (å¦‚ -0.4, 0.7)

### Q4: ExcelæŠ¥å‘Šä¸­"â†³æ—¶é—´æ®µ"æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

**A:** è¡¨ç¤ºè¿™ä¸€è¡Œæ˜¯ä¸Šä¸€è¡Œæ–‡ä»¶çš„é—®é¢˜æ—¶æ®µè¯¦æƒ…ã€‚æ¯ä¸ªNOKæ–‡ä»¶å ç”¨ä¸¤è¡Œï¼šç¬¬ä¸€è¡Œæ˜¾ç¤ºé—®é¢˜å¸§IDï¼Œç¬¬äºŒè¡Œæ˜¾ç¤ºå…·ä½“æ—¶é—´æ®µã€‚

---

## æ›´æ–°æ—¥å¿—

### v6 (2026-02-11)
- âœ… å®ç°æ··åˆè¾¹ç•Œåˆ†æç®—æ³•
- âœ… å­¤ç«‹å¸§ï¼šä¸ç›¸é‚»OKå¸§æ¯”è¾ƒ
- âœ… è¿ç»­å¸§ï¼šé¦–å°¾å·®å¼‚åˆ†æ
- âœ… ExcelæŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ

### v5 (2026-02-10)
- è¾¹ç•Œåˆ†æç®—æ³•åˆç‰ˆ
- ç»Ÿä¸€è¾¹ç•Œåˆ†æç­–ç•¥

### v4 (2026-02-10)
- å·®é›†åˆ†æç®—æ³•
- çª—å£è¦†ç›–è¿‡æ»¤

### v3 (2026-02-09)
- ä¸¤é˜¶æ®µåˆ¤å®šé€»è¾‘
- MOSä¼˜å…ˆåˆ¤æ–­

---

## OK/NOKåˆ¤å®šé€»è¾‘

### æ–¹æ¡ˆ3ï¼šæ··åˆåˆ¤å®šï¼ˆå½“å‰å®ç°ï¼‰

**è®¾è®¡ç†å¿µï¼šå¸§çº§ä¸ºä¸» + çªå˜æ£€æµ‹ + æ–‡ä»¶çº§å‚è€ƒ**

#### åˆ¤å®šæ ‡å‡†

##### MOSç»´åº¦ï¼ˆæ ¸å¿ƒè´¨é‡æŒ‡æ ‡ï¼‰

```python
if percent_below_baseline > 50%:
    # ä¸»è¦ä¾æ®ï¼šè¶…è¿‡ä¸€åŠå¸§åŠ£åŒ–
    status = 'MOS_NOK'
    reason = f"{percent_below_baseline:.0f}%å¸§åŠ£åŒ–"

elif min_diff < -0.5:
    # è¾…åŠ©ä¾æ®ï¼šå­˜åœ¨ä¸¥é‡çªå˜
    status = 'MOS_NOK'
    reason = f"ä¸¥é‡çªé™({min_diff:.2f})"

elif percent_below_baseline > 30% and file_level_diff < -0.05:
    # å‚è€ƒä¾æ®ï¼šè¾¹ç•Œæƒ…å†µå‚è€ƒæ–‡ä»¶çº§
    status = 'MOS_NOK'
    reason = f"{percent_below_baseline:.0f}%å¸§åŠ£åŒ–+æ–‡ä»¶çº§åŠ£åŒ–"
```

##### å…¶ä»–ç»´åº¦ï¼ˆNOI/DIS/COL/LOUDï¼‰

```python
if percent_below_baseline > 70%:
    # ä¸»è¦ä¾æ®ï¼šè¶…è¿‡70%å¸§åŠ£åŒ–
    status = f'{DIM}_NOK'
    reason = f"{percent_below_baseline:.0f}%å¸§åŠ£åŒ–"

elif min_diff < -0.5:
    # è¾…åŠ©ä¾æ®ï¼šä¸¥é‡çªå˜
    status = f'{DIM}_NOK'
    reason = f"ä¸¥é‡çªé™({min_diff:.2f})"

elif percent_below_baseline > 50% and mean_diff < -0.2:
    # æŒç»­åŠ£åŒ–
    status = f'{DIM}_NOK'
    reason = f"{percent_below_baseline:.0f}%å¸§åŠ£åŒ–+å¹³å‡åŠ£åŒ–{mean_diff:.2f}"

elif percent_below_baseline > 40% and file_level_diff < -0.1:
    # å‚è€ƒä¾æ®ï¼šè¾¹ç•Œæƒ…å†µ
    status = f'{DIM}_NOK'
    reason = f"{percent_below_baseline:.0f}%å¸§åŠ£åŒ–+æ–‡ä»¶çº§åŠ£åŒ–"
```

#### åˆ¤å®šé€»è¾‘æµç¨‹å›¾

```
å¼€å§‹é€ç»´åº¦åˆ¤å®š
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ä¸»è¦ä¾æ®ï¼ˆå¸§çº§ï¼‰  â”‚
â”‚  MOS: >50%å¸§åŠ£åŒ–     â”‚ â”€â”€â”€â”€> NOK
â”‚  å…¶ä»–: >70%å¸§åŠ£åŒ–    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ æœªè§¦å‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è¾…åŠ©ä¾æ®ï¼ˆçªå˜ï¼‰  â”‚
â”‚  å•å¸§å·®å€¼ < -0.5     â”‚ â”€â”€â”€â”€> NOK
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ æœªè§¦å‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æŒç»­åŠ£åŒ–åˆ¤å®š     â”‚
â”‚  >50%å¸§ + å¹³å‡<-0.2  â”‚ â”€â”€â”€â”€> NOK
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ æœªè§¦å‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å‚è€ƒä¾æ®ï¼ˆæ–‡ä»¶çº§ï¼‰â”‚
â”‚  40-50%å¸§åŠ£åŒ– +      â”‚ â”€â”€â”€â”€> NOK
â”‚  æ–‡ä»¶çº§å·®å€¼å¼‚å¸¸      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ æœªè§¦å‘
   OK
```

#### åˆ¤å®šç»“æœç¤ºä¾‹

```
ã€è´¨é‡åˆ¤å®šã€‘ NOK (MOS_NOK, NOI_NOK, COL_NOK, LOUD_NOK)
ã€åˆ¤å®šä¾æ®ã€‘
  - MOS: 100%å¸§åŠ£åŒ–, ä¸¥é‡çªé™(-0.96)
  - NOI: 100%å¸§åŠ£åŒ–
  - COL: 100%å¸§åŠ£åŒ–
  - LOUD: 100%å¸§åŠ£åŒ–

æ–‡ä»¶çº§è´¨é‡å¯¹æ¯”
MOS    2.844  2.806  -0.038  â‰ˆ ç›¸å½“  ï¼ˆè¢«å¸§çº§è¦†ç›–ï¼‰
```

**å…³é”®ç‚¹ï¼š** 
- æ–‡ä»¶çº§æ˜¾ç¤º"ç›¸å½“"ï¼Œä½†å¸§çº§å‘ç°100%åŠ£åŒ– â†’ æœ€ç»ˆåˆ¤å®šNOK
- ä½“ç°äº†"å¸§çº§ä¸ºä¸»"çš„è®¾è®¡ç†å¿µ

---

## è¶‹åŠ¿ä¸å¼‚å¸¸æ£€æµ‹

### 1. çº¿æ€§è¶‹åŠ¿åˆ†æ

```python
def _analyze_trend(diffs):
    x = np.arange(len(diffs))
    slope, intercept = np.polyfit(x, diffs, 1)
    
    if abs(slope) < 0.001:
        type = 'stable'
        description = 'ç¨³å®šï¼ˆä¸åŸºå‡†å·®å¼‚ä¿æŒæ’å®šï¼‰'
    elif slope > 0.01:
        type = 'improving'
        description = 'æ”¹å–„è¶‹åŠ¿ï¼ˆè´¨é‡é€æ¸æ¥è¿‘æˆ–è¶…è¶ŠåŸºå‡†ï¼‰'
    elif slope < -0.01:
        type = 'degrading'
        description = 'æ¶åŒ–è¶‹åŠ¿ï¼ˆè´¨é‡é€æ¸è¿œç¦»åŸºå‡†ï¼‰'
    else:
        type = 'slight_fluctuation'
        description = 'è½»å¾®æ³¢åŠ¨'
    
    return {'type': type, 'description': description, 'slope': slope}
```

**è¶‹åŠ¿ç±»å‹è§£è¯»ï¼š**
- **ç¨³å®šï¼š** è´¨é‡é—®é¢˜æŒç»­å­˜åœ¨ä½†ä¸æ¶åŒ–ï¼ˆå¦‚æŒç»­çš„åº•å™ªï¼‰
- **æ”¹å–„è¶‹åŠ¿ï¼š** è´¨é‡é€æ¸æ¥è¿‘åŸºå‡†ï¼ˆå¦‚éŸ³é¢‘å¼€å¤´æœ‰é—®é¢˜ï¼Œåé¢æ¢å¤ï¼‰
- **æ¶åŒ–è¶‹åŠ¿ï¼š** è´¨é‡é€æ¸è¿œç¦»åŸºå‡†ï¼ˆå¦‚è®¾å¤‡é€æ¸è¿‡çƒ­å¯¼è‡´åŠ£åŒ–ï¼‰
- **è½»å¾®æ³¢åŠ¨ï¼š** éšæœºæ³¢åŠ¨ï¼Œæ— æ˜æ˜¾è¶‹åŠ¿

### 2. çªå˜ç‚¹æ£€æµ‹

```python
sudden_drops = []
for i in range(1, len(diffs)):
    if diffs[i] - diffs[i-1] < -0.5:  # çªç„¶ä¸‹é™>0.5
        sudden_drops.append({
            'frame': i,
            'drop': diffs[i] - diffs[i-1],
            'time': i * 0.5  # è½¬æ¢ä¸ºç§’
        })
```

**å…¸å‹çªå˜åœºæ™¯ï¼š**
- **å™ªå£°çªå‘ï¼š** NOIåœ¨æŸå¸§çªç„¶ä¸‹é™ï¼ˆå¦‚ç”µç£å¹²æ‰°ï¼‰
- **ä¸¢åŒ…/å¡é¡¿ï¼š** DISçªç„¶ä¸‹é™ï¼ˆç½‘ç»œé—®é¢˜ï¼‰
- **éŸ³é‡çªå˜ï¼š** LOUDçªé™ï¼ˆAGCå¤±æ•ˆã€è®¾å¤‡æ•…éšœï¼‰

**æŠ¥å‘Šç¤ºä¾‹ï¼š**
```
çªå˜ç‚¹æ£€æµ‹: å‘ç° 2 å¤„çªç„¶ä¸‹é™
  - Frame 2 (1.0s): COLä¸‹é™-0.617
  - Frame 10 (5.0s): LOUDä¸‹é™-0.508
```

### 3. å¼‚å¸¸æ¨¡å¼è¯†åˆ«

**æç«¯æ³¢åŠ¨ï¼š** æ ‡å‡†å·® > 0.3
```python
if std_diff > 0.3:
    extreme_variability.append(file)
```

**æŒç»­åŠ£åŒ–ï¼š** >70%å¸§ä½äºåŸºå‡†
```python
if percent_below_baseline > 70:
    persistent_degradation.append(file)
```

**å¤šç»´åº¦åŒæ—¶å¤±è´¥ï¼š** â‰¥3ç»´åº¦åŒæ—¶>50%åŠ£åŒ–
```python
failed_dims = [dim for dim in dimensions if percent_below[dim] > 50]
if len(failed_dims) >= 3:
    multi_dimension_failure.append(file)
```

---

## è¾“å‡ºä¸å¯è§†åŒ–

### 1. æ§åˆ¶å°è¾“å‡º

```
================================================================================
NISQA åŸºå‡†å¯¹æ¯”åˆ†ææŠ¥å‘Š
================================================================================

ã€åŸºå‡†æ–‡ä»¶ã€‘ framewise_BOXP_WHS_R.json
ã€æµ‹è¯•æ–‡ä»¶ã€‘ framewise_260206142207_30.1.65.182_BOXP_WHS_R.json
ã€æ€»å¸§æ•°ã€‘   29
ã€è´¨é‡åˆ¤å®šã€‘ NOK (MOS_NOK, NOI_NOK, COL_NOK, LOUD_NOK)
ã€åˆ¤å®šä¾æ®ã€‘
  - MOS: 100%å¸§åŠ£åŒ–, ä¸¥é‡çªé™(-0.90)
  - NOI: 100%å¸§åŠ£åŒ–
  - COL: 100%å¸§åŠ£åŒ–
  - LOUD: 100%å¸§åŠ£åŒ–

--------------------------------------------------------------------------------
æ–‡ä»¶çº§è´¨é‡å¯¹æ¯”
--------------------------------------------------------------------------------
ç»´åº¦           åŸºå‡†         æµ‹è¯•         å·®å€¼         çŠ¶æ€
--------------------------------------------------------------------------------
MOS          2.844      2.785      -0.059     â‰ˆ ç›¸å½“
NOI          4.132      4.040      -0.091     â‰ˆ ç›¸å½“
...

================================================================================
å¸§çº§è¯¦ç»†åˆ†æ (NOKæ–‡ä»¶)
================================================================================

ã€MOS - æ€»ä½“è´¨é‡ã€‘
  å¹³å‡å·®å€¼:         -0.541
  ä½äºåŸºå‡†å¸§æ•°:     29 / 29 (100.0%)
  è¶‹åŠ¿åˆ†æ:         è½»å¾®æ³¢åŠ¨
  âš ï¸  è´¨é‡é—®é¢˜: ä¸¥é‡åŠ£åŒ–ï¼ˆè¶…è¿‡50%å¸§ä½äºåŸºå‡†ï¼‰

ã€NOI - å™ªå£°ç¨‹åº¦ã€‘
  çªå˜ç‚¹æ£€æµ‹:       å‘ç° 1 å¤„çªç„¶ä¸‹é™
    - Frame 3: ä¸‹é™ -0.783
```

### 2. è¶‹åŠ¿å›¾å¯è§†åŒ–ï¼ˆPNGï¼‰

**5ä¸ªå­å›¾ï¼Œæ¯ä¸ªç»´åº¦ä¸€å¼ ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MOS (æ€»ä½“è´¨é‡)                               â”‚
â”‚                                              â”‚
â”‚ 4.0 â”                                        â”‚
â”‚     â”‚ â”â”â” ç»¿è‰²å®çº¿ï¼šåŸºå‡†                     â”‚
â”‚ 3.5 â”¤ â”â”â” è“è‰²å®çº¿ï¼šæµ‹è¯•                     â”‚
â”‚     â”‚ â–“â–“â–“ çº¢è‰²å¡«å……ï¼šåŠ£äºåŸºå‡†                 â”‚
â”‚ 3.0 â”¤ â–‘â–‘â–‘ ç»¿è‰²å¡«å……ï¼šä¼˜äºåŸºå‡†                 â”‚
â”‚     â”‚                                        â”‚
â”‚ 2.5 â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’     â”‚
â”‚         0s    5s    10s   15s   æ—¶é—´        â”‚
â”‚                                              â”‚
â”‚ å¹³å‡å·®å€¼: -0.541 | ä½äºåŸºå‡†: 100.0%         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å›¾è¡¨ç‰¹ç‚¹ï¼š**
- Xè½´ï¼šæ—¶é—´ï¼ˆç§’ï¼‰
- Yè½´ï¼šè´¨é‡åˆ†æ•°ï¼ˆ1-5ï¼‰
- ç»¿çº¿ï¼šåŸºå‡†éŸ³é¢‘æ¯å¸§çš„å€¼
- è“çº¿ï¼šæµ‹è¯•éŸ³é¢‘æ¯å¸§çš„å€¼
- çº¢è‰²å¡«å……ï¼šæµ‹è¯•å€¼ < åŸºå‡†ï¼ˆé—®é¢˜åŒºåŸŸï¼‰
- ç»¿è‰²å¡«å……ï¼šæµ‹è¯•å€¼ â‰¥ åŸºå‡†ï¼ˆè‰¯å¥½åŒºåŸŸï¼‰

**å¿«é€Ÿåˆ¤æ–­ï¼š**
- çº¢è‰²å¡«å……å¤š â†’ NOK
- ç»¿è‰²å¡«å……å¤š â†’ OK
- å‡ºç°å°–é”çªé™ â†’ çªå˜äº‹ä»¶

### 3. JSONæ•°æ®è¾“å‡º

```json
{
  "test_file": "260206142207_30.1.65.182_BOXP_WHS_R",
  "baseline_file": "BOXP_WHS_R",
  "status": "NOK",
  "nok_dimensions": ["MOS_NOK", "NOI_NOK", "COL_NOK", "LOUD_NOK"],
  "nok_reasons": {
    "MOS": "100%å¸§åŠ£åŒ–, ä¸¥é‡çªé™(-0.90)",
    "NOI": "100%å¸§åŠ£åŒ–",
    "COL": "100%å¸§åŠ£åŒ–",
    "LOUD": "100%å¸§åŠ£åŒ–"
  },
  "file_level": {
    "baseline": {"mos": 2.844, "noi": 4.132, ...},
    "test": {"mos": 2.785, "noi": 4.040, ...},
    "diff": {"mos": -0.059, "noi": -0.091, ...}
  },
  "metrics": {
    "mos": {
      "frame_diffs": [
        {
          "frame_id": 0,
          "time_start": 0.0,
          "baseline_value": 3.123,
          "test_value": 2.567,
          "diff": -0.556
        },
        ...
      ],
      "stats": {
        "mean_diff": -0.541,
        "percent_below_baseline": 100.0,
        "min_diff": -0.900,
        ...
      },
      "trend": {
        "type": "slight_fluctuation",
        "slope": 0.0023,
        "sudden_drops": [...]
      }
    },
    ...
  }
}
```

### 4. æ±‡æ€»æŠ¥å‘Šï¼ˆanalyze_summary.pyï¼‰

```
================================================================================
NISQA åŸºå‡†å¯¹æ¯”åˆ†æ - è´¨é‡é—®é¢˜æ±‡æ€»æŠ¥å‘Š
================================================================================

ğŸ“Š æ•´ä½“ç»Ÿè®¡
  æ€»æ–‡ä»¶æ•°: 56
  âœ“ OKæ–‡ä»¶: 3 (5.4%)
  âœ— NOKæ–‡ä»¶: 53 (94.6%)

ğŸ“ˆ NOKæ–‡ä»¶é—®é¢˜ç»´åº¦åˆ†å¸ƒ
ç»´åº¦              æ–‡ä»¶æ•°
------------------------------
MOS_NOK         53
NOI_NOK         52
COL_NOK         48
LOUD_NOK        50
DIS_NOK         51

ğŸš¨ NOKæ–‡ä»¶è¯¦æƒ…
================================================================================

ã€260206142207_30.1.65.182_BOXP_WHS_Rã€‘
  é—®é¢˜ç»´åº¦: MOS_NOK, NOI_NOK, COL_NOK, LOUD_NOK
  åˆ¤å®šä¾æ®:
    - MOS: 100%å¸§åŠ£åŒ–, ä¸¥é‡çªé™(-0.90)
    - NOI: 100%å¸§åŠ£åŒ–
    - COL: 100%å¸§åŠ£åŒ–
    - LOUD: 100%å¸§åŠ£åŒ–
  æ–‡ä»¶çº§å·®å€¼: MOS=-0.059, NOI=-0.091, DIS=+0.009, COL=-0.027, LOUD=-0.027
```

---

## å…³é”®è®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆ"å¸§çº§ä¸ºä¸»"ï¼Ÿ

**ä¼ ç»Ÿé—®é¢˜ï¼ˆä»…æ–‡ä»¶çº§ï¼‰ï¼š**
```
æ–‡ä»¶çº§MOS: 3.5 (æ­£å¸¸)
ä½†å®é™…ï¼šå¼€å¤´5ç§’å¡é¡¿ä¸¥é‡ï¼Œåé¢æ­£å¸¸
â†’ æ–‡ä»¶çº§ç®—æ³•å¯èƒ½å°†é—®é¢˜"å¹³å‡"æ‰
```

**å¸§çº§è§£å†³æ–¹æ¡ˆï¼š**
```
å¸§çº§åˆ†æï¼š
- Frame 0-10: MOSå…¨éƒ¨<2.0 (å¡é¡¿)
- Frame 11-29: MOSå…¨éƒ¨>4.0 (æ­£å¸¸)
â†’ åˆ¤å®š: NOK (è¶…è¿‡30%å¸§åŠ£åŒ–)
â†’ å®šä½: 0-5ç§’é—®é¢˜æ—¶æ®µ
```

### 2. ä¸ºä»€ä¹ˆéœ€è¦çªå˜æ£€æµ‹ï¼Ÿ

**åœºæ™¯ï¼š** æ•´ä½“è´¨é‡å°šå¯ï¼Œä½†å­˜åœ¨1-2å¸§ä¸¥é‡é—®é¢˜

```
99%å¸§: MOSå·®å€¼ -0.1 (è½»å¾®åŠ£åŒ–)
1å¸§: MOSå·®å€¼ -1.2 (ä¸¥é‡å¡é¡¿)

æŒ‰æ¯”ä¾‹åˆ¤å®š â†’ OK (ä»…1%åŠ£åŒ–)
ä½†å®é™… â†’ ç”¨æˆ·ä½“éªŒæå·®ï¼ˆæ˜æ˜¾å¡é¡¿ï¼‰

çªå˜æ£€æµ‹ â†’ NOK (æ£€æµ‹åˆ°ä¸¥é‡çªé™)
```

### 3. ä¸ºä»€ä¹ˆä¿ç•™æ–‡ä»¶çº§ä½œä¸ºå‚è€ƒï¼Ÿ

**è¾¹ç•Œæƒ…å†µï¼š** 40-50%å¸§åŠ£åŒ–ï¼Œä¸ç¡®å®šæ˜¯å¦NOK

```
å¦‚æœæ–‡ä»¶çº§å·®å€¼ä¹Ÿå¼‚å¸¸ â†’ ç¡®è®¤NOK
å¦‚æœæ–‡ä»¶çº§å·®å€¼æ­£å¸¸ â†’ å¯èƒ½æ˜¯æµ‹é‡æ³¢åŠ¨ï¼Œåˆ¤å®šOK
```

---

## ä½¿ç”¨å»ºè®®

### 1. åŸºå‡†æ–‡ä»¶é€‰æ‹©

**âŒ é”™è¯¯åšæ³•ï¼š**
```
é€‰æ‹©MOS=2.8çš„ä½è´¨é‡æ–‡ä»¶ä½œåŸºå‡†
â†’ å¯¼è‡´æ‰€æœ‰æ­£å¸¸æ–‡ä»¶éƒ½è¢«åˆ¤å®šNOK
```

**âœ… æ­£ç¡®åšæ³•ï¼š**
```
1. å…ˆåˆ†ææ‰€æœ‰æ–‡ä»¶çš„ç»å¯¹è´¨é‡
2. é€‰æ‹©MOS > 3.5çš„é«˜è´¨é‡æ–‡ä»¶ä½œåŸºå‡†
3. æˆ–é€‰æ‹©"æœŸæœ›è´¨é‡"çš„ä»£è¡¨æ€§æ ·æœ¬
```

### 2. é˜ˆå€¼è°ƒæ•´

**æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ï¼š**

```python
# ä¸¥æ ¼æ¨¡å¼ï¼ˆé«˜è´¨é‡è¦æ±‚ï¼‰
MOS_NOK: percent_below > 30%  # é™ä½é˜ˆå€¼

# å®½æ¾æ¨¡å¼ï¼ˆå®¹å¿è½»å¾®é—®é¢˜ï¼‰
MOS_NOK: percent_below > 70%  # æé«˜é˜ˆå€¼
```

### 3. åˆ†æç­–ç•¥

**å¤§æ‰¹é‡æ–‡ä»¶ï¼ˆ>100ï¼‰ï¼š**
```
1. å…ˆç”¨æ–‡ä»¶çº§å¿«é€Ÿç­›é€‰
2. å¯¹å¯ç–‘æ–‡ä»¶è¿›è¡Œå¸§çº§è¯¦ç»†åˆ†æ
3. åªè¾“å‡ºNOKæ–‡ä»¶çš„è¯¦ç»†æŠ¥å‘Š
```

**å°æ‰¹é‡æ–‡ä»¶ï¼ˆ<20ï¼‰ï¼š**
```
ç›´æ¥è¿›è¡Œå®Œæ•´çš„å¸§çº§å¯¹æ¯”åˆ†æ
```

---

## å±€é™æ€§ä¸æ³¨æ„äº‹é¡¹

### 1. NISQAæ¨¡å‹æœ¬èº«çš„å±€é™

- **è®­ç»ƒæ•°æ®åå·®ï¼š** ä¸»è¦åŸºäºP.808æ•°æ®é›†ï¼Œå¯èƒ½å¯¹æŸäº›ç‰¹å®šåœºæ™¯ï¼ˆå¦‚æœºå™¨äººéŸ³ï¼‰æ•æ„Ÿåº¦ä¸è¶³
- **çª—å£æ•ˆåº”ï¼š** 15ç§’çª—å£å¯èƒ½æ— æ³•æ•æ‰æçŸ­æš‚çš„é—®é¢˜ï¼ˆ<1ç§’ï¼‰
- **è¯„åˆ†ä¸€è‡´æ€§ï¼š** å¸§çº§è¯„åˆ†ç®—æ³•ä¸æ–‡ä»¶çº§ä¸åŒï¼Œå¯èƒ½å‡ºç°çŸ›ç›¾

### 2. å¯¹é½ç®—æ³•å±€é™

- **å‡è®¾ï¼š** éŸ³é¢‘å†…å®¹ç›¸ä¼¼åº¦é«˜
- **å¤±æ•ˆåœºæ™¯ï¼š** å®Œå…¨ä¸åŒçš„éŸ³é¢‘å†…å®¹ä¼šäº§ç”Ÿé”™è¯¯å¯¹é½
- **å»ºè®®ï¼š** å¯¹é½åæ£€æŸ¥lagå€¼ï¼Œå¦‚æœ>5å¸§å¯èƒ½æœ‰é—®é¢˜

### 3. åˆ¤å®šé˜ˆå€¼çš„ä¸»è§‚æ€§

- **50%/70%é˜ˆå€¼** æ˜¯åŸºäºç»éªŒè®¾å®š
- ä¸åŒåœºæ™¯å¯èƒ½éœ€è¦ä¸åŒæ ‡å‡†
- å»ºè®®ï¼šæ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯éªŒè¯å’Œè°ƒæ•´

---

## æ€»ç»“

**NISQAæ£€æµ‹ç³»ç»Ÿçš„æ ¸å¿ƒä¼˜åŠ¿ï¼š**

âœ… **ç²¾å‡†å®šä½ï¼š** å¸§çº§åˆ†æç¡®å®šé—®é¢˜æ—¶æ®µ  
âœ… **å¯è§£é‡Šæ€§ï¼š** è¶‹åŠ¿å›¾ç›´è§‚å±•ç¤ºåŠ£åŒ–åŒºåŸŸ  
âœ… **è‡ªåŠ¨å¯¹é½ï¼š** å¤„ç†æ—¶é—´åç§»é—®é¢˜  
âœ… **æ··åˆåˆ¤å®šï¼š** ç»“åˆå¤šç§åˆ¤æ®ï¼Œå‡å°‘è¯¯åˆ¤  
âœ… **å…¨é¢ç»Ÿè®¡ï¼š** 5ç»´åº¦Ã—å¤šæŒ‡æ ‡ï¼Œå…¨æ–¹ä½è¯„ä¼°  

**é€‚ç”¨åœºæ™¯ï¼š**
- VoIPé€šè¯è´¨é‡ç›‘æ§
- éŸ³é¢‘ç¼–è§£ç å™¨è¯„æµ‹
- è®¾å¤‡æ•…éšœè¯Šæ–­
- ç½‘ç»œè´¨é‡åˆ†æ
- æ‰¹é‡éŸ³é¢‘è´¨é‡ç­›æŸ¥

**æ ¸å¿ƒç†å¿µï¼š**
> "è®©è¶‹åŠ¿å›¾è¯´è¯ï¼Œç”¨å¸§çº§æ•°æ®å†³ç­–"
